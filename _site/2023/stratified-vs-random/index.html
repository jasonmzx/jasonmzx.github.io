








<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>jasonmzx | Jason Manarroo | Stratified VS. Random Sampling </title>
    <link rel="shortcut icon" type="image/png" href="/favicon.png" >
    <meta name="theme-color" content="#222222"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/assets/css/fa-svg.css" rel="stylesheet">
    <link href="/assets/css/bootstrap4.min.css" rel="stylesheet">
    <link href="/assets/css/theme.css" rel="stylesheet">
    <link href="/assets/css/syntax.css" rel="stylesheet">
 </head>

<body>

<nav class="navbar navbar-expand-sm navbar-dark">
    <div class="navbar-collapse" style="display: block;">
        <div style="margin-bottom: 1vh; padding-left: 3vw;">
        <a class="navbar-brand " href="/">
            <!-- <img class="navbar-img" src="/favicon.png"> -->
            jasonmzx | Jason Manarroo
        </a>
        <br>
        <span style="color:#2AAA8A; font-weight: 600;">Software Engineering Student</span>
    </div>

        <div class="navbar-nav" style="flex-wrap: wrap;">

            <a class="nav-item nav-link" href="/">
                
                <svg xmlns="http://www.w3.org/2000/svg" height="19px" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.857 17.082a23.848 23.848 0 005.454-1.31A8.967 8.967 0 0118 9.75v-.7V9A6 6 0 006 9v.75a8.967 8.967 0 01-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 01-5.714 0m5.714 0a3 3 0 11-5.714 0M3.124 7.5A8.969 8.969 0 015.292 3m13.416 0a8.969 8.969 0 012.168 4.5" />
                  </svg>
                  

            Home</a>

            <a class="nav-item nav-link" href="/recent/">
                
                <svg xmlns="http://www.w3.org/2000/svg" height="19px"fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
                </svg>

            Recent</a>

            <a class="nav-item nav-link" href="/archive">

            <svg xmlns="http://www.w3.org/2000/svg" height="19px" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125" />
                  </svg>
                  

            Archive</a>

            <a class="nav-item nav-link" href="/tags">
            
            <svg xmlns="http://www.w3.org/2000/svg" height="19px"  fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 6h.008v.008H6V6z" />
                  </svg>
                  

            Tags</a>
            <a class="nav-item nav-link" href="/projects">
                <svg xmlns="http://www.w3.org/2000/svg" height="19px"  fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 6.75L22.5 12l-5.25 5.25m-10.5 0L1.5 12l5.25-5.25m7.5-3l-4.5 16.5" />
                  </svg>

            Projects</a>
        </div>
    </div>
</nav>

    <div class="wrapper">
      <div class="content">
        <div class="container container-center">
          <div class="row">
            <div class="col-md-8 offset-md-1">
              <div class="article">
                <div class="card">
                  <h1><a href="/2023/stratified-vs-random/">Stratified VS. Random Sampling</a></h1>
                  <div class="post-meta">
                    <div class="post-time">
                      <!-- <i class="fa fa-calendar-alt"></i> -->
                      <svg class="svg-inline--fa fa-calendar-alt fa-w-14" aria-hidden="true" data-prefix="fa" data-icon="calendar-alt"
    role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg="">
    <path fill="currentColor"
        d="M436 160H12c-6.6 0-12-5.4-12-12v-36c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48v36c0 6.6-5.4 12-12 12zM12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm116 204c0-6.6-5.4-12-12-12H76c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40zm0-128c0-6.6-5.4-12-12-12H76c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40zm128 128c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40zm0-128c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40zm128 128c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40zm0-128c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12v-40z">
    </path>
</svg>
                      <time>30 Jul 2023</time>
                    </div>
                    <ul>
                      
                        <li>
                          <a href="/tag/machine-learning">machine-learning</a></li>
                      
                        <li>
                          <a href="/tag/github">github</a></li>
                      
                        <li>
                          <a href="/tag/devops">devops</a></li>
                      
                    </ul>
                  </div>
                  <div class="post-content">
                    
                      <ul class="toc">
  <li><a href="#stratified-sampling">Stratified Sampling:</a></li>
  <li><a href="#random-sampling">Random Sampling:</a></li>
</ul>
                    
                    <h2 id="stratified-sampling">Stratified Sampling:</h2>

<p><img src="/assets/custom/pictures/stratified_sampled.png" alt="Stratified Sampling" /></p>

<p><a href="https://www.wallstreetmojo.com/stratified-sampling/">Source_for_example_1_WallStreetMojo.com</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedShuffleSplit</span>

<span class="n">split</span> <span class="o">=</span> <span class="nc">StratifiedShuffleSplit</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="k">for</span> <span class="n">train_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="ow">in</span> <span class="n">split</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">dataset</span><span class="p">[</span><span class="sh">"</span><span class="s">income</span><span class="sh">"</span><span class="p">]):</span>
    <span class="n">strat_train_set</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">train_index</span><span class="p">]</span>
    <span class="n">strat_test_set</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test_index</span><span class="p">]</span>
</code></pre></div></div>
<p><a href="https://machine-learning-apps.github.io/hands-on-ml2/02_end_to_end_machine_learning_project">Code Credits from hands-on-ml2-notebooks , CH.2</a></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">test_size</code> refers to the amount of the dataset you’re sub-setting (here it’s set to 20%)</li>
  <li><code class="language-plaintext highlighter-rouge">random_state</code> is an optional parameter that’s great to use as static seed, and replicate a certain pattern of randomness again. <em>(E.G: I got 2 datasets, data and labels, with the same size and indices, I can just both Shuffle them by the same seed, and they will match!)</em></li>
</ul>

<p>In the <strong>for loop</strong>, Iterating over the Stratified Split data specifically by the <code class="language-plaintext highlighter-rouge">income</code> parameter, so it will basically sample an income distribution proportional to our dataset. <em>(For the the <code class="language-plaintext highlighter-rouge">strat_train_set</code> Stratified Training Dataset, &amp; <code class="language-plaintext highlighter-rouge">strat_test_set</code> Stratified Test Dataset)</em></p>

<p><strong>Notice how both stratified datasets have similar proportions :D</strong><br />
<img src="/assets/custom/pictures/stratified_jupyter.png" alt="Output of strat_&quot;" /></p>

<h2 id="random-sampling">Random Sampling:</h2>

<p><img src="/assets/custom/pictures/random_sample.png" alt="Random Sampling" /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># For illustration only. Sklearn has train_test_split()
</span><span class="k">def</span> <span class="nf">split_train_test</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">test_ratio</span><span class="p">):</span>
    <span class="n">shuffled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">permutation</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="n">test_set_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">*</span> <span class="n">test_ratio</span><span class="p">)</span>
    <span class="n">test_indices</span> <span class="o">=</span> <span class="n">shuffled_indices</span><span class="p">[:</span><span class="n">test_set_size</span><span class="p">]</span>
    <span class="n">train_indices</span> <span class="o">=</span> <span class="n">shuffled_indices</span><span class="p">[</span><span class="n">test_set_size</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_indices</span><span class="p">]</span>
</code></pre></div></div>

<ul>
  <li>This block of code is basically equivalent to Sklearn’s random test set splitter.</li>
  <li>Uses NumPy to get permutation of the data (randomly sorted), then splits to at <code class="language-plaintext highlighter-rouge">test_ratio</code> and returns.</li>
</ul>

<p><strong>Behold, the Sklearn equivalent:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train_set</span><span class="p">,</span> <span class="n">test_set</span> <span class="o">=</span> <span class="nf">train_test_split</span><span class="p">(</span><span class="n">housing</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>Notice that we can also use the <code class="language-plaintext highlighter-rouge">random_state</code> param again for replicable randomness!</li>
</ul>

                  </div>
                  
                </div>
              </div>
            </div>
            <div class="col-md-3 hidden-xs">
              <div class="sidebar ">
  <h2>Latest Activity</h2>
  <ul>
    
    <li><a href="/2023/clip-maps/">Clipmapping (Optimized "Open-World" Rendering Techniques for Games)</a></li>
    
    <li><a href="/2023/react-in-production/">React In Production</a></li>
    
    <li><a href="/2023/kick-tracker-init/">Punch & Kick Tracking using Camera</a></li>
    
    <li><a href="/2023/stratified-vs-random/">Stratified VS. Random Sampling</a></li>
    
    <li><a href="/2023/first-post/">First Post!</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>Tags</h2>
  <ul class="fa-ul">
    
    
    <li>
      
      
<span class="fa-li">
    <svg class="svg-inline--fa fa-tag fa-w-16" aria-hidden="true" 
        data-prefix="fas" data-icon="tag"
        role="img"
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 512 512" 
        data-fa-i2svg="">
        <path fill="currentColor"
            d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z">
        </path>
    </svg>
</span>

      <!-- <span class="fa-li"><i class="fas fa-tag"></i></span> -->

            <a href="/tag/computer-graphics" data-toggle="tooltip" data-placement="right" title="1">
        <span>computer-graphics</span></a>
    </li>
    
    <li>
      
      
<span class="fa-li">
    <svg class="svg-inline--fa fa-tag fa-w-16" aria-hidden="true" 
        data-prefix="fas" data-icon="tag"
        role="img"
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 512 512" 
        data-fa-i2svg="">
        <path fill="currentColor"
            d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z">
        </path>
    </svg>
</span>

      <!-- <span class="fa-li"><i class="fas fa-tag"></i></span> -->

            <a href="/tag/devops" data-toggle="tooltip" data-placement="right" title="1">
        <span>devops</span></a>
    </li>
    
    <li>
      
      
<span class="fa-li">
    <svg class="svg-inline--fa fa-tag fa-w-16" aria-hidden="true" 
        data-prefix="fas" data-icon="tag"
        role="img"
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 512 512" 
        data-fa-i2svg="">
        <path fill="currentColor"
            d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z">
        </path>
    </svg>
</span>

      <!-- <span class="fa-li"><i class="fas fa-tag"></i></span> -->

            <a href="/tag/github" data-toggle="tooltip" data-placement="right" title="2">
        <span>github</span></a>
    </li>
    
    <li>
      
      
<span class="fa-li">
    <svg class="svg-inline--fa fa-tag fa-w-16" aria-hidden="true" 
        data-prefix="fas" data-icon="tag"
        role="img"
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 512 512" 
        data-fa-i2svg="">
        <path fill="currentColor"
            d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z">
        </path>
    </svg>
</span>

      <!-- <span class="fa-li"><i class="fas fa-tag"></i></span> -->

            <a href="/tag/machine-learning" data-toggle="tooltip" data-placement="right" title="2">
        <span>machine-learning</span></a>
    </li>
    
    <li>
      
      
<span class="fa-li">
    <svg class="svg-inline--fa fa-tag fa-w-16" aria-hidden="true" 
        data-prefix="fas" data-icon="tag"
        role="img"
        xmlns="http://www.w3.org/2000/svg" 
        viewBox="0 0 512 512" 
        data-fa-i2svg="">
        <path fill="currentColor"
            d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z">
        </path>
    </svg>
</span>

      <!-- <span class="fa-li"><i class="fas fa-tag"></i></span> -->

            <a href="/tag/react.js" data-toggle="tooltip" data-placement="right" title="1">
        <span>react.js</span></a>
    </li>
    
  </ul>
</div>

            </div>
          </div>
        </div>
      </div>
      
    </div>
  </body>
</html>
